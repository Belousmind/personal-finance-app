"use client";

import Link from "next/link";
import { useState, useEffect } from "react";

import { NAVIGATION_DATA } from "@/constants";
import SideBarLink from "./sidebar-link";

import styles from "./style.module.scss";
import clsx from "clsx";

export default function SideBar() {
  const [isClosed, setIsClosed] = useState(false);

  useEffect(() => {
    const handleResize = () => {
      if (window.innerWidth <= 900 && !isClosed) {
        setIsClosed(false);
      }
    };

    window.addEventListener("resize", handleResize);
    return () => window.removeEventListener("resize", handleResize);
  }, []);

  const toggleMenu = () => {
    setIsClosed((prev) => !prev);
  };

  return (
    <aside className={clsx(styles.menu, { [styles.closed]: isClosed })}>
      <Link className={styles.logo} href="/">
        <LogoIcon />
      </Link>
      <nav className={styles.nav}>
        {NAVIGATION_DATA.map((menuItem, index) => {
          const { icon, label, link } = menuItem;
          return (
            <SideBarLink key={index} icon={icon} label={label} link={link} />
          );
        })}
      </nav>

      <MenuButton onToggle={toggleMenu} />
    </aside>
  );
}

type MenuButtonProps = {
  onToggle: () => void;
};

function MenuButton({ onToggle }: MenuButtonProps) {
  return (
    <button onClick={onToggle} className={`${styles.button}`}>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
      >
        <path
          d="M15 7.49998L15 16.5C15 16.6989 14.921 16.8897 14.7803 17.0303C14.6397 17.171 14.4489 17.25 14.25 17.25H12L12 21C12.0001 21.1484 11.9562 21.2935 11.8738 21.417C11.7914 21.5404 11.6742 21.6366 11.5371 21.6934C11.4 21.7503 11.2491 21.7651 11.1035 21.7361C10.9579 21.7071 10.8242 21.6356 10.7194 21.5306L1.71935 12.5306C1.64962 12.461 1.5943 12.3782 1.55656 12.2872C1.51882 12.1961 1.49939 12.0985 1.49939 12C1.49939 11.9014 1.51882 11.8038 1.55656 11.7128C1.5943 11.6217 1.64962 11.539 1.71935 11.4694L10.7194 2.46936C10.8242 2.36435 10.9579 2.29282 11.1035 2.26383C11.2491 2.23485 11.4 2.2497 11.5371 2.30651C11.6742 2.36333 11.7914 2.45955 11.8738 2.58299C11.9562 2.70644 12.0001 2.85156 12 2.99998V6.74998H14.25C14.4489 6.74998 14.6397 6.829 14.7803 6.96965C14.921 7.1103 15 7.30107 15 7.49998ZM17.25 6.74998C17.0511 6.74998 16.8603 6.829 16.7196 6.96965C16.579 7.1103 16.5 7.30107 16.5 7.49998V16.5C16.5 16.6989 16.579 16.8897 16.7196 17.0303C16.8603 17.171 17.0511 17.25 17.25 17.25C17.4489 17.25 17.6397 17.171 17.7803 17.0303C17.921 16.8897 18 16.6989 18 16.5L18 7.49998C18 7.30107 17.921 7.1103 17.7803 6.96965C17.6397 6.829 17.4489 6.74998 17.25 6.74998ZM20.25 6.74998C20.0511 6.74998 19.8603 6.829 19.7196 6.96965C19.579 7.1103 19.5 7.30107 19.5 7.49998L19.5 16.5C19.5 16.6989 19.579 16.8897 19.7196 17.0303C19.8603 17.171 20.0511 17.25 20.25 17.25C20.4489 17.25 20.6397 17.171 20.7803 17.0303C20.921 16.8897 21 16.6989 21 16.5L21 7.49998C21 7.30107 20.921 7.1103 20.7803 6.96965C20.6397 6.829 20.4489 6.74998 20.25 6.74998Z"
          fill="currentColor"
        />
      </svg>
      <span>Minimize Menu</span>
    </button>
  );
}

function LogoIcon() {
  return (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="122"
      height="22"
      viewBox="0 0 122 22"
      fill="none"
    >
      <path
        d="M8.192 21.44H2.176V10.24H0V5.312H2.304C2.944 2.272 5.92 0 11.2 0H12.48V4.288H10.24C8.576 4.288 7.776 4.448 7.808 5.312H12.48V10.24H8.192V21.44Z"
        fill="white"
      />
      <path
        d="M20.1047 3.84H14.0887V0H20.1047V3.84ZM20.1047 21.44H14.0887V5.312H20.1047V21.44Z"
        fill="white"
      />
      <path
        d="M28.3622 21.44H22.3462V5.312H27.9783V10.208H28.2983C28.6502 7.52 30.4103 4.992 34.7303 4.992C39.0823 4.992 41.1302 7.616 41.1302 11.104V21.44H35.1143V13.312C35.1143 11.072 34.2822 10.368 31.6582 10.368C29.0022 10.368 28.3622 11.04 28.3622 13.12V21.44Z"
        fill="white"
      />
      <path
        d="M48.4447 21.76C44.7967 21.76 42.7487 20.096 42.7487 17.344C42.7487 15.072 44.3167 13.44 47.9647 13.088L54.5247 12.448V12.128C54.5247 10.496 53.8208 10.24 51.6768 10.24C49.6927 10.24 49.0848 10.624 49.0848 11.968V12.096H43.0687V12.032C43.0687 7.744 46.6527 4.992 52.1247 4.992C57.7567 4.992 60.4767 7.744 60.4767 12.256V21.44H54.8447V18.048H54.5247C53.9167 20.32 51.9327 21.76 48.4447 21.76ZM48.7967 16.96C48.7967 17.472 49.3087 17.568 50.2367 17.568C53.1487 17.568 54.3327 17.216 54.4927 15.776L49.5648 16.352C49.0208 16.416 48.7967 16.608 48.7967 16.96Z"
        fill="white"
      />
      <path
        d="M68.596 21.44H62.58V5.312H68.212V10.208H68.532C68.884 7.52 70.644 4.992 74.964 4.992C79.316 4.992 81.364 7.616 81.364 11.104V21.44H75.348V13.312C75.348 11.072 74.516 10.368 71.892 10.368C69.236 10.368 68.596 11.04 68.596 13.12V21.44Z"
        fill="white"
      />
      <path
        d="M92.5185 21.76C86.7905 21.76 83.1425 18.592 83.1425 13.376C83.1425 8.128 86.7905 4.992 92.5185 4.992C98.0225 4.992 101.542 7.808 101.542 12.128V12.64H95.5585V12.384C95.5585 10.72 94.3425 10.368 92.3905 10.368C90.1825 10.368 89.1265 10.848 89.1265 13.376C89.1265 15.872 90.1825 16.352 92.3905 16.352C94.3425 16.352 95.5585 16.032 95.5585 14.368V14.08H101.542V14.624C101.542 18.912 98.0225 21.76 92.5185 21.76Z"
        fill="white"
      />
      <path
        d="M112.462 21.76C106.99 21.76 103.15 19.424 103.15 13.376C103.15 8.128 106.958 4.992 112.334 4.992C117.902 4.992 121.454 7.776 121.454 12.96C121.454 13.504 121.422 13.92 121.358 14.496H108.718C108.814 16.448 109.678 16.992 112.238 16.992C114.67 16.992 115.31 16.576 115.31 15.616V15.264H121.326V15.648C121.326 19.232 117.902 21.76 112.462 21.76ZM112.206 9.6C109.998 9.6 109.07 10.08 108.814 11.456H115.63C115.406 10.08 114.446 9.6 112.206 9.6Z"
        fill="white"
      />
    </svg>
  );
}
